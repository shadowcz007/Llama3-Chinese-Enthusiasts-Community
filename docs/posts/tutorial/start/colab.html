<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.9" />
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html,
      body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme')
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia('(prefers-color-scheme: dark)').matches
      if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
        document.documentElement.classList.toggle('dark', true)
      }
    </script>
    <meta property="og:url" content="https://llama3.fun/posts/tutorial/start/colab.html"><meta property="og:site_name" content="Llama3 Fun 爱好者社区"><meta property="og:title" content="Llama3 微调教程：超简单，人人都可以打造属于自己的 GPT！"><meta property="og:description" content="colab"><meta property="og:type" content="article"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2024-05-05T13:49:06.000Z"><meta property="article:modified_time" content="2024-05-05T13:49:06.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Llama3 微调教程：超简单，人人都可以打造属于自己的 GPT！","image":[""],"dateModified":"2024-05-05T13:49:06.000Z","author":[]}</script><meta name="description" content="Connecting the world"><meta name="keywords" content="Llama3, Chinese community, open source, innovation,中文社区, 开源项目, 创新"><meta name="author" content="shadow"><script src="/javascript/translate.js"></script><script src="/javascript/model-viewer.min.js" type="module"></script><meta name="google-site-verification" content="1"><link rel="icon" href="/favicon.ico"><title>Llama3 微调教程：超简单，人人都可以打造属于自己的 GPT！ | Llama3 Fun 爱好者社区</title>
    <link rel="preload" href="/assets/style-DYfEvdu3.css" as="style"><link rel="stylesheet" href="/assets/style-DYfEvdu3.css">
    <link rel="modulepreload" href="/assets/app-Cg4OVFg8.js"><link rel="modulepreload" href="/assets/colab.html-dnBZQqdC.js">
    <link rel="prefetch" href="/assets/index.html-BdNmRSPW.js" as="script"><link rel="prefetch" href="/assets/mission.html-B-7Pq6KC.js" as="script"><link rel="prefetch" href="/assets/index.html-48XwnKZt.js" as="script"><link rel="prefetch" href="/assets/index.html-Vb0Gyj1U.js" as="script"><link rel="prefetch" href="/assets/index.html-eEsRsHVL.js" as="script"><link rel="prefetch" href="/assets/llm.html-BcBovgTu.js" as="script"><link rel="prefetch" href="/assets/404.html-CFth28De.js" as="script"><link rel="prefetch" href="/assets/index.html-gfBGaA6z.js" as="script"><link rel="prefetch" href="/assets/index.html-BsDrpRNy.js" as="script"><link rel="prefetch" href="/assets/index.html-BgeZM9-l.js" as="script"><link rel="prefetch" href="/assets/index.html-DtUa94fI.js" as="script"><link rel="prefetch" href="/assets/index.html-ClTBM-r9.js" as="script"><link rel="prefetch" href="/assets/index.html-BNpwK6cx.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="logo" src="/logo.png" alt="Llama3 Fun 爱好者社区"><span class="site-name can-hide" aria-hidden="true">Llama3 Fun 爱好者社区</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="基础教程"><span class="title">基础教程</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="基础教程"><span class="title">基础教程</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/posts/tutorial/start/" aria-label="微调简版"><!--[--><!--[--><!--]--> 微调简版 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link route-link-active" href="/posts/tutorial/start/colab.html" aria-label="微调Colab版"><!--[--><!--[--><!--]--> 微调Colab版 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/posts/tutorial/start/llm.html" aria-label="本地LLM指南"><!--[--><!--[--><!--]--> 本地LLM指南 <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="route-link" href="/posts/dataset/" aria-label="数据集"><!--[--><!--[--><!--]--> 数据集 <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/posts/model/" aria-label="模型"><!--[--><!--[--><!--]--> 模型 <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/posts/mission.html" aria-label="使命"><!--[--><!--[--><!--]--> 使命 <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/shadowcz007/Llama3-Chinese-Enthusiasts-Community" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--[--><select id="translateSelectLanguage"><option value="Not Translate" selected="selected">Not Translate</option><option value="Default">Auto Translate</option><option value="english">English</option><option value="chinese_simplified">简体中文</option><option value="chinese_traditional">繁體中文</option><option value="russian">Русский</option><option value="japanese">しろうと</option><option value="korean">한국어</option><option value="deutsch">Deutsch</option><option value="spanish">Español</option><option value="italian">italiano</option><option value="norwegian">Norge</option><option value="dutch">nederlands</option><option value="filipino">Pilipino</option><option value="lao">ກະຣຸນາ</option><option value="romanian">Română</option><option value="nepali">नेपालीName</option><option value="french">Français</option><option value="haitian_creole">Kreyòl ayisyen</option><option value="czech">český</option><option value="swedish">Svenska</option><option value="russian">Русский язык</option><option value="malagasy">Malagasy</option><option value="burmese">ဗာရမ်</option><option value="pashto">پښتوName</option><option value="thai">คนไทย</option><option value="armenian">Արմենյան</option><option value="persian">Persian</option><option value="kurdish">Kurdî</option><option value="turkish">Türkçe</option><option value="hindi">हिन्दी</option><option value="bulgarian">български</option><option value="malay">Malay</option><option value="swahili">Kiswahili</option><option value="oriya">ଓଡିଆ</option><option value="irish">Íris</option><option value="gujarati">ગુજરાતી</option><option value="slovak">Slovenská</option><option value="hebrew">היברית</option><option value="hungarian">magyar</option><option value="marathi">मराठीName</option><option value="tamil">தாமில்</option><option value="estonian">eesti keel</option><option value="malayalam">മലമാലം</option><option value="inuktitut">ᐃᓄᒃᑎᑐᑦ</option><option value="arabic">بالعربية</option><option value="slovene">slovenščina</option><option value="bengali">বেঙ্গালী</option><option value="urdu">اوردو</option><option value="azerbaijani">azerbaijani</option><option value="portuguese">português</option><option value="samoan">lifiava</option><option value="afrikaans">afrikaans</option><option value="greek">ελληνικά</option><option value="danish">dansk</option><option value="amharic">amharic</option><option value="albanian">albanian</option><option value="lithuanian">Lietuva</option><option value="vietnamese">Tiếng Việt</option><option value="maltese">Malti</option><option value="finnish">suomi</option><option value="catalan">català</option><option value="croatian">hrvatski</option><option value="bosnian">bosnian</option><option value="polish">Polski</option><option value="latvian">latviešu</option><option value="maori">Maori</option></select><!--]--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items" aria-label="site navigation"><!--[--><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="基础教程"><span class="title">基础教程</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="基础教程"><span class="title">基础教程</span><span class="right arrow"></span></button><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="route-link" href="/posts/tutorial/start/" aria-label="微调简版"><!--[--><!--[--><!--]--> 微调简版 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link route-link-active" href="/posts/tutorial/start/colab.html" aria-label="微调Colab版"><!--[--><!--[--><!--]--> 微调Colab版 <!--[--><!--]--><!--]--></a></li><li class="navbar-dropdown-item"><a class="route-link" href="/posts/tutorial/start/llm.html" aria-label="本地LLM指南"><!--[--><!--[--><!--]--> 本地LLM指南 <!--[--><!--]--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-item"><a class="route-link" href="/posts/dataset/" aria-label="数据集"><!--[--><!--[--><!--]--> 数据集 <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/posts/model/" aria-label="模型"><!--[--><!--[--><!--]--> 模型 <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><a class="route-link" href="/posts/mission.html" aria-label="使命"><!--[--><!--[--><!--]--> 使命 <!--[--><!--]--><!--]--></a></div><div class="navbar-item"><a class="external-link" href="https://github.com/shadowcz007/Llama3-Chinese-Enthusiasts-Community" rel="noopener noreferrer" target="_blank" aria-label="Github"><!--[--><!--[--><!--]--> Github <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Llama3 微调教程：超简单，人人都可以打造属于自己的 GPT！ <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#_1、访问-unsloth" aria-label="1、访问 Unsloth"><!--[--><!--[--><!--]--> 1、访问 Unsloth <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_2、创建-colab-笔记副本" aria-label="2、创建 Colab 笔记副本"><!--[--><!--[--><!--]--> 2、创建 Colab 笔记副本 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_3、连接-t4-gpu" aria-label="3、连接 T4 GPU"><!--[--><!--[--><!--]--> 3、连接 T4 GPU <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_4、连接-google-drive" aria-label="4、连接 Google Drive"><!--[--><!--[--><!--]--> 4、连接 Google Drive <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#步入正题" aria-label="步入正题"><!--[--><!--[--><!--]--> 步入正题 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#_1-选择预训练模型" aria-label="1. 选择预训练模型"><!--[--><!--[--><!--]--> 1. 选择预训练模型 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_2-配置-lora-参数" aria-label="2. 配置 LoRA 参数"><!--[--><!--[--><!--]--> 2. 配置 LoRA 参数 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_3-准备数据" aria-label="3. 准备数据"><!--[--><!--[--><!--]--> 3. 准备数据 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_4-训练模型" aria-label="4. 训练模型"><!--[--><!--[--><!--]--> 4. 训练模型 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_5-测试训练效果" aria-label="5. 测试训练效果"><!--[--><!--[--><!--]--> 5. 测试训练效果 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_6-保存模型和加载模型" aria-label="6. 保存模型和加载模型"><!--[--><!--[--><!--]--> 6. 保存模型和加载模型 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#本地使用模型" aria-label="本地使用模型"><!--[--><!--[--><!--]--> 本地使用模型 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#_1-下载-lm-studio-的客户端" aria-label="1.下载 LM Studio 的客户端"><!--[--><!--[--><!--]--> 1.下载 LM Studio 的客户端 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_2-导入模型" aria-label="2. 导入模型"><!--[--><!--[--><!--]--> 2. 导入模型 <!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link sidebar-item" href="#_3-开始聊天" aria-label="3. 开始聊天"><!--[--><!--[--><!--]--> 3. 开始聊天 <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><a class="route-link sidebar-item" href="#总结" aria-label="总结"><!--[--><!--[--><!--]--> 总结 <!--[--><!--]--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a class="route-link sidebar-item" href="#参考资料" aria-label="参考资料："><!--[--><!--[--><!--]--> 参考资料： <!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="llama3-微调教程-超简单-人人都可以打造属于自己的-gpt" tabindex="-1"><a class="header-anchor" href="#llama3-微调教程-超简单-人人都可以打造属于自己的-gpt"><span>Llama3 微调教程：超简单，人人都可以打造属于自己的 GPT！</span></a></h1><p><a href="https://mp.weixin.qq.com/s/VV1BUMQIMrb5LxQNusQsDg" target="_blank" rel="noopener noreferrer">colab 版<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>作者：PM 熊叔</p><p>随着 Llama 3 的发布，国内各路英雄豪杰纷纷开启了炼丹之旅。Llama-3 8b 在惊人的 15 万亿令牌上训练，而 Llama-2 仅为 2 万亿。毋庸置疑，Llama 3 目前是开源大模型中能力最强的！其跑分成绩已经赶上了 GPT-4。</p><p><img src="/assets/x1-BC3GzZXi.webp" alt=""></p><p>然而，Llama 的优势不仅限于此。作为开源大模型，每个人都可以对其进行定制，这意味着相比 GPT，它具有更强的定制性和安全性。Llama 可应用于针对 B 端企业的自然语言处理、机器翻译、文本生成、问答系统、聊天机器人等场景。</p><p>目前，我们主要通过微调（Fine-Tuning）来定制所需的模型。例如，Llama 3 原生不支持中文，但我们可以通过微调让它支持中文。</p><p>微调是指在已经经过大规模预训练的基础模型上，使用特定领域或任务的数据集对模型进行额外训练，以适应特定任务或问题。微调过程通常包括在预训练模型的基础上进行少量迭代训练，以调整模型参数，使其在特定任务上表现更好。</p><p>通过这个简单的 Llama 3 微调案例，我们可以体验整个大模型微调的过程。对于普通人来说，这是一个免费体验算法工程师工作方式的机会；如果你想转入 AI 行业，这也是一个很好的入门案例。</p><p>愿每个人都能从中受益，开启自己的 AI 探索之旅！</p><p>接下来，你将学习如何进行环境配置、数据准备、模型训练、模型运行、模型保存以及本地模型使用。在开始之前，让我们先完成一些准备工作。</p><p>准备工作</p><h2 id="_1、访问-unsloth" tabindex="-1"><a class="header-anchor" href="#_1、访问-unsloth"><span>1、访问 Unsloth</span></a></h2><p>目前，最简单的方法是使用 Unsloth，它是一个微调模型的集成工具。通过 Unsloth 微调 Mistral、Gemma、Llama，速度提高 2-5 倍，内存减少 70%！</p><p><a href="https://github.com/unslothai/unsloth" target="_blank" rel="noopener noreferrer">访问 Unsloth 的 GitHub 地址<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>，点击 &quot;▶️Start on Colab&quot; &quot;即可打开 Colab 训练脚本。</p><p><img src="/assets/x2-CYGOxmgd.webp" alt=""></p><p>为了方便大家快速上手，我已经将其翻译成<a href="https://colab.research.google.com/drive/1pvzl7E2rdTF7LkDQZOTyl32_Vu9Zwe4N?usp=sharing" target="_blank" rel="noopener noreferrer">中文并简化<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p>如果你是初学者，建议使用我修改过的 Colab 笔记。</p><p><img src="/assets/x3-B3VUxJXe.webp" alt=""></p><h2 id="_2、创建-colab-笔记副本" tabindex="-1"><a class="header-anchor" href="#_2、创建-colab-笔记副本"><span>2、创建 Colab 笔记副本</span></a></h2><p>使用 Colab 的好处是标准化的环境，免去了很多问题。我们先将笔记复制为副本，这样它能保存到自己的 Google Drive 中。</p><p><img src="/assets/x4-vKvjg8B-.webp" alt=""></p><p><img src="/assets/x5-Dm8KAfZl.webp" alt=""></p><h2 id="_3、连接-t4-gpu" tabindex="-1"><a class="header-anchor" href="#_3、连接-t4-gpu"><span>3、连接 T4 GPU</span></a></h2><p>你可以免费使用 Google 提供的 GPU 资源，选择连接 T4。当连接成功后，就可以开始了。</p><p><img src="/assets/x6-DqTaJLTc.webp" alt=""></p><p>你也可以在弹框中选择 T4 GPU。</p><p><img src="/assets/x7-BQn_i0TC.webp" alt=""></p><p>当链接成功后，你就准备就绪了。</p><p><img src="/assets/x8-CfNmRVIF.webp" alt=""></p><h2 id="_4、连接-google-drive" tabindex="-1"><a class="header-anchor" href="#_4、连接-google-drive"><span>4、连接 Google Drive</span></a></h2><p>我们需要连接 Google Drive，以便将训练好的模型保存到云端。使用 Colab 非常简单，你基本只需依次点击运行每个代码块即可。</p><p><img src="/assets/x9-BjhxhVlL.webp" alt=""></p><p>5、安装 Unsloth</p><p>点击运行，这段代码主要是安装 Unsloth 和模型训练相关的必要库。</p><p><img src="/assets/x10-BjXLoxn_.webp" alt=""></p><p>展示执行时间表示已经执行过了。</p><p><img src="/assets/x11-BDYY6BsO.webp" alt=""></p><h2 id="步入正题" tabindex="-1"><a class="header-anchor" href="#步入正题"><span>步入正题</span></a></h2><p>一切准备就绪，我们要进入正式流程了</p><h3 id="_1-选择预训练模型" tabindex="-1"><a class="header-anchor" href="#_1-选择预训练模型"><span>1. 选择预训练模型</span></a></h3><p>这一段代码主要用于选择我们要训练的模型，代码中已经帮我们选择好了&quot;unsloth/llama-3-8b-bnb-4bit&quot;。继续点击运行，等待模型下载完成。</p><p><img src="/assets/x12-DQ-RU01B.webp" alt=""></p><p>点击之后，我们会看到它正在下载模型，需要等待它执行完毕。</p><p><img src="/assets/x13-BYwvJ5Jq.webp" alt=""></p><h3 id="_2-配置-lora-参数" tabindex="-1"><a class="header-anchor" href="#_2-配置-lora-参数"><span>2. 配置 LoRA 参数</span></a></h3><p>我们的微调是通过 LoRA 实现的。LoRA（Low-Rank Adaptation of Large Language Models）是大语言模型的低阶适配器，用于在模型微调过程中只更新整个模型参数的一小部分，通常在 1%到 10%之间。</p><p>继续点击运行。</p><p><img src="/assets/x14-BmYEGeZ9.webp" alt=""></p><h3 id="_3-准备数据" tabindex="-1"><a class="header-anchor" href="#_3-准备数据"><span>3. 准备数据</span></a></h3><p>微调模型最重要的是数据。这里我们使用 yahma 的 Alpaca 数据集，它包含 52,000 条由 OpenAI 的 text-davinci-003 引擎生成的指令和演示数据。这些指令数据可用于对语言模型进行指令调优，使其更好地遵循指令。</p><p>Alpaca 的数据结构如下</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>&quot;instruction&quot;: &quot;描述原子的结构。&quot;,
&quot;input&quot;: &quot;&quot;,
&quot;output&quot;: &quot;原子是所有物质的基本组成部分，由三种类型的粒子组成：质子、中子和电子。原子的结构可以描述为中心有一个原子核，周围环绕着电子云。原子核由质子和中子组成。质子是带正电的粒子，中子是不带电荷的中性粒子……&quot;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>每条数据，结构由三部分组成：instruction (指令)、input(输入)和 output(输出)，我们可以根据这个格式准备自己的数据集。</p><p>instruction（指令）：这部分定义了要求 AI 执行的任务或问题。它是一条明确的指示，告诉 AI 需要做什么。例如，&quot;识别以下句子中的名词&quot;或&quot;我应该投资股票吗？&quot;。</p><p>input（输入）：这部分提供了执行指令所需的具体信息或上下文。在某些情况下，这个部分可能为空，表示指令本身已经包含了执行任务所需的所有信息。</p><p>output（输出）：这部分是 AI 根据给定的指令和输入生成的答案或结果。它是 AI 处理完输入信息后的响应或解决方案。</p><p>继续点击播放，执行代码。</p><p><img src="/assets/x15-DYshf5ZL.webp" alt=""></p><h3 id="_4-训练模型" tabindex="-1"><a class="header-anchor" href="#_4-训练模型"><span>4. 训练模型</span></a></h3><p>现在让我们使用 Huggingface TRL 的 SFTTrainer 库来训练模型，我们设置 max_steps 最大步数为 60 步来加快训练速度，让我们继续无脑的点击播放：</p><p><img src="/assets/x16-CCSqOtEe.webp" alt=""></p><p>然后，就可以开始正式训练模型了。</p><p><img src="/assets/x17-DbGR7mN4.webp" alt=""></p><h3 id="_5-测试训练效果" tabindex="-1"><a class="header-anchor" href="#_5-测试训练效果"><span>5. 测试训练效果</span></a></h3><p>训练完成后，我们可以测试模型效果。这里我们先让它生成斐波那契数列（Fibonacci sequence）。</p><p><img src="/assets/x18-ORmu1Toc.webp" alt=""></p><p>你也可以更改指令 instruction 和输入 input，测试你想要的内容。但是注意需要使用英文。</p><p>另外，我们还可以使用流格式，像使用 GPT 一样，一个个字地输出。</p><p><img src="/assets/x19-CHX8FXbS.webp" alt=""></p><h3 id="_6-保存模型和加载模型" tabindex="-1"><a class="header-anchor" href="#_6-保存模型和加载模型"><span>6. 保存模型和加载模型</span></a></h3><p>目前，我们模型已经训练好了，我们可以将刚刚训练的 LoRA 保存下来。</p><p>6.1.保存和加载 LoRA 模型</p><p>点击运行，将 LoRA 模型保存到 Colab 的临时服务器中。</p><p><img src="/assets/x20-DDn4AbgN.webp" alt=""></p><p>训练好的 LoRA 模型保存在 lora_model 文件夹中。</p><p><img src="/assets/x21-eqMgXX33.webp" alt=""></p><p>如果你想加载刚刚训练的 LoRA 模型进行测试，可以执行相应的代码。</p><p><img src="/assets/x22-D9-zO9_m.webp" alt=""></p><p>6.2 保存为 GGUF 模型</p><p>目前较为常用的模型格式是 GGUF，我们可以使用 LM Studio 在本地加载使用。</p><p>这段代码可以将模型保存为不同的精度格式，建议使用 Q4_K，生成的体积比较小，只有 4GB。</p><p><img src="/assets/x23-D_0Gq4Vp.webp" alt=""></p><p>生成的模型在这里，但是直接下载比较难。</p><p><img src="/assets/x24-DjYrJFXX.webp" alt=""></p><p>我们可以执行这段代码，将生成的模型移动到 Google 云端硬盘中，这样下载更方便。</p><p><img src="/assets/x25-Btpoytcu.webp" alt=""></p><p>移动完成后，访问 Google 云端硬盘即可下载 GGUF 模型。</p><p>地址：https://drive.google.com/drive/my-drive</p><p><img src="/assets/x26-C6rkEBSo.webp" alt=""></p><p>这样我们微调的整个过程就完成了。恭喜你！</p><h2 id="本地使用模型" tabindex="-1"><a class="header-anchor" href="#本地使用模型"><span>本地使用模型</span></a></h2><h3 id="_1-下载-lm-studio-的客户端" tabindex="-1"><a class="header-anchor" href="#_1-下载-lm-studio-的客户端"><span>1.下载 LM Studio 的客户端</span></a></h3><p><a href="https://lmstudio.ai" target="_blank" rel="noopener noreferrer">访问<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> 下载 LM Studio 的客户端，它可以加载我们刚刚训练的模型。</p><p><img src="/assets/x27-FsPEkw1z.webp" alt=""></p><h3 id="_2-导入模型" tabindex="-1"><a class="header-anchor" href="#_2-导入模型"><span>2. 导入模型</span></a></h3><p>将 GGUF 文件放到 LM Studio 的模型文件夹中。打开保存模型的文件夹目录：models。</p><p><img src="/assets/x28-CWvE0l3U.webp" alt=""></p><p>在指定路径中创建文件夹，目录结构为<code>llama3/model-unsloth/</code>。在 models 文件夹中新建一个文件夹 llama3，然后再创建一个模型文件夹 model-unsloth，将下载的模型放进去。</p><p><img src="/assets/x29-CD1mNmI4.webp" alt=""></p><p>设置完成后，重启 LM Studio。</p><h3 id="_3-开始聊天" tabindex="-1"><a class="header-anchor" href="#_3-开始聊天"><span>3. 开始聊天</span></a></h3><p>选择模型后，就可以开始聊天了。</p><p><img src="/assets/x30-BwQwndGF.webp" alt=""></p><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2><p>本教程详细介绍了如何使用 Unsloth 和 Google Colab 环境对 Llama 3 进行微调。使用 Colab 基本上是无脑点击运行就好了。</p><p>经过这个教程，我们发现微调模型主要有三个核心环节：</p><p>数据准备，这一步决定了质量；</p><p>模型训练，这一步硬件资源决定了时间；</p><p>模型测试，因为我们初步体验，所以比较简略，后续可以进一步探讨。</p><p>通过本教程，即使是 AI 领域的新手也能够掌握大模型的微调技术。Unsloth 不仅降低了技术门槛，也为个人和小团队提供了强大的工具。</p><p>如果还有问题，可以查看我的 notebook 或者进群讨论。希望你能将这些知识应用于实际问题，解锁更多的可能性。</p><p><a href="https://docs.qq.com/form/page/DU1FReEpXdkpKWHlO" target="_blank" rel="noopener noreferrer">模型训练的交流群申请<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h3 id="参考资料" tabindex="-1"><a class="header-anchor" href="#参考资料"><span>参考资料：</span></a></h3><p><a href="https://mp.weixin.qq.com/s/qcBddyN8srFB0MPh5shgtQ" target="_blank" rel="noopener noreferrer">简版<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><p><a href="https://mp.weixin.qq.com/s/VV1BUMQIMrb5LxQNusQsDg" target="_blank" rel="noopener noreferrer">colab版<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><!----></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: chizhiwei007@163.com">shadowcz007</span><!----><!--]--><!--]--></span></div></div></footer><!----><!--[--><!--[--><div class="my-footer">MIT Licensed | Copyright © 2024-present Llama3 Fun 爱好者社区</div><!--]--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-Cg4OVFg8.js" defer></script>
  </body>
</html>
